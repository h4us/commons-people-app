<DockLayout #messageEditor width="100%" height="100%">
  <StackLayout dock="top" class="bg-theme-secondary" height="60">
    <CustomActionBar [title]="title" leftIcon="&#xea02;" rightIcon="{{ selected?.length > 0 ? '&#xe92b;' : '' }}"
      (onCancel)="closeModal(messageEditor)"
      (onAprove)="ok(messageEditor)"></CustomActionBar>
  </StackLayout>

  <ScrollView class="bg-theme-secondary">
    <StackLayout>
      <StackLayout padding="20 20 25" width="100%">
        <SearchboxLike *ngIf="!isSearchMode"
          placeholder="名前で絞り込む"
          (onSearch)="switchMode()"></SearchboxLike>
        <CustomSearchbox *ngIf="isSearchMode"
          placeholder="名前で絞り込む"
          followContent="キャンセル"
          focusAtInit="true"
          (onSearch)="searchAction($event)"
          (onTapFollowContent)="switchMode()"></CustomSearchbox>
      </StackLayout>

      <!-- // -->
      <ActivityIndicator *ngIf="currentList?.length == 0" busy="true" width="20"></ActivityIndicator>

      <!-- // -->
      <ng-template ngFor let-item [ngForOf]="currentList" let-i="index">
        <StackLayout class="bg-theme-secondary"
          visibility="{{ ignore.indexOf(item?.id) >= 0 ? 'collapsed' : 'visible' }}">
          <CardView margin="1 20" elevation="5" class="bg-white"
            (tap)="onItemTap(item)">
            <StackLayout class="bg-clear">
              <GridLayout columns="80,*,60" rows="90" class="bg-clear">
                <Image col="0" class="m-x-10" style="border-radius:80;" stretch="aspectFill" width="60" height="60"
                  src="{{ item?.avatarUrl || '~/assets/placeholder__user.png' }}"></Image>
                <StackLayout col="1" orientation="horizontal" class="p-10">
                  <Label class="h3" text="{{ item?.username }}" virticalAlignment="stretch"></Label>
                </StackLayout>
                <Label col="2" class="h2 p-10 icon"
                  [class.text-theme]="selected.indexOf(item.id) > -1"
                  text="{{ selected.indexOf(item?.id) > -1 ? '&#xe92c;' : '&#xe937;' }}" style="vertical-align:center;"></Label>
              </GridLayout>
            </StackLayout>
          </CardView>
        </StackLayout>
      </ng-template>

      <StackLayout class="p-x-10 bg-theme-secondary">
        <FlexboxLayout
          flexDirection="column"
          justifyContent="space-around"
          alignItems="center"
          height="90">
          <Button *ngIf="currentList.length > 0 && currentQueryParams?.pagination?.lastPage > currentQueryParams?.pagination?.page"
            class="btn btn-rounded-lg btn-primary btn-black" width="40%" text="さらに読む"
            (tap)="moreResult()"></Button>
        </FlexboxLayout>
      </StackLayout>

    </StackLayout>
  </ScrollView>

</DockLayout>
